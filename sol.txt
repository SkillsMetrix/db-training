package com.service;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.entity.Product;
import com.repo.ProductRepo;

@Service
public class ProductService {
	@Autowired
	private ProductRepo repo;
	
	
	public Product addProduct(Product product) {
		return repo.save(product);
	}

	public List<Product> loadProduct(){
		return (List<Product>)repo.findAll();
	}
	
	public String purchaseProduct(int id,int qty) {
		return repo.findById(id).map(product -> {
			if(product.getQuantityAvailable() >=qty) {
				product.setQuantityAvailable(product.getQuantityAvailable()- qty);
				repo.save(product);
				return "Purchase Successfull...!";
			}else {
				return "not enough quantity available";
			}
		}).orElse("Product Not Found");
	}
}
-------------


package com.controller;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import com.entity.Product;
import com.service.ProductService;

@RestController
@RequestMapping("/shopcart")
public class ProductController {
	@Autowired
	private ProductService service;
	@PostMapping("/addproduct")
	public ResponseEntity<Product> addProduct(@RequestBody Product product){
		return ResponseEntity.ok(service.addProduct(product));
		
	}
	@GetMapping("/loadproducts")
	public ResponseEntity<List<Product>> loadProduct(){
		return ResponseEntity.ok(service.loadProduct());
		
	}
	@PostMapping("/purchaseproduct/{id}/{quantity}")
	public ResponseEntity<String> purchaseProduct(@PathVariable int id,@PathVariable int quantity){
		return ResponseEntity.ok(service.purchaseProduct(id, quantity));
		
	}

}
